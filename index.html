<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-box id="myBox" position="0 0 -5" color="red"></a-box>
    </a-scene>

    <script>
      // Get reference to the box entity
      var box = document.querySelector('#myBox');

      // Initialize compass data
      var compassHeading = 0;

      // Initialize position data
      var positionX = 0;
      var positionY = 0;
      var positionZ = -5;

      // Initialize scale factor
      var scaleFactor = 1;

      // Add deviceorientation event listener
      window.addEventListener('deviceorientation', function(event) {
        // Get compass heading (in degrees)
        compassHeading = event.alpha;
      });

      // Update rotation of the box based on compass heading
      function updateRotation() {
        box.setAttribute('rotation', {x: 0, y: compassHeading, z: 0});
        requestAnimationFrame(updateRotation);
      }
      updateRotation();

      // Start Accelerometer API
      if (window.Accelerometer) {
        var accelerometer = new Accelerometer({frequency: 60});
        accelerometer.addEventListener('reading', function() {
          // Get acceleration values
          var accelerationX = accelerometer.x;
          var accelerationY = accelerometer.y;
          var accelerationZ = accelerometer.z;

          // Update position based on compass heading and acceleration values
          var compassRad = compassHeading * (Math.PI / 180);
          var distanceX = Math.sin(compassRad) * accelerationX;
          var distanceZ = Math.cos(compassRad) * accelerationX;
          positionX += distanceX / 50;
          positionY += accelerationY / 50;
          positionZ += distanceZ / 50;

          // Set position of the box
          box.setAttribute('position', {x: positionX, y: positionY, z: positionZ});

          // Calculate distance from compass heading and update scale factor
          var distance = Math.abs(compassHeading) / 180;
          scaleFactor = 1 + distance;

          // Set scale of the box based on scale factor
          box.object3D.scale.set(scaleFactor, scaleFactor, scaleFactor);
        });
        accelerometer.start();
      }
    </script>
  </body>
</html>
